<!doctype html>
<html>
<head>
<meta charset="utf-8">

  <title>Demo &raquo; Multiple gridster intances &raquo; gridster.js</title>
  <link rel="stylesheet" type="text/css" href="css/jquery.gridster.min.css">
  <link rel="stylesheet" type="text/css" href="css/demo.css">
  <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap-theme.min.css">

</head>

<body>    
    <div class="header">
        GUT持续集成看板
    </div>
    
    <div class="content">
        <div class="main-block product ">
            <div class="jobs-group product">
                <div class="group-header" id="txt_product"></div>
                <div class="group-content" id="jobs_product"></div>
            </div>
        </div>
        <div class="main-block sub-project" id="box_sub_project"></div>
        <div class="main-block module" id="box_module"></div>

    </div>

    <script type="text/javascript" src="js/jquery-2.0.3.min.js"></script>
    <script src="js/angular.min.js" type="text/javascript" charset="utf-8">></script>
    <!--script src="js/jquery.gridster.min.js" type="text/javascript" charset="utf-8"></script-->

    <script type="text/javascript">
        //var data = {"gut":{"jobs":[{"name":"jruby-rack-dist","buildable":true,"healthReport":[{"score":60}],"lastBuild":{"building":false,"result":"SUCCESS","url":"http://ci.jruby.org/job/jruby-rack-dist/1038/"}}],"submodules":{"ems":{"jobs":[{"name":"jruby-rack-dist","buildable":true,"healthReport":[{"score":60}],"lastBuild":{"building":false,"result":"SUCCESS","url":"http://ci.jruby.org/job/jruby-rack-dist/1038/"}}],"submodules":{"north":{"jobs":[{"name":"jruby-rack-dist","buildable":true,"healthReport":[{"score":60}],"lastBuild":{"building":false,"result":"SUCCESS","url":"http://ci.jruby.org/job/jruby-rack-dist/1038/"}}]},"app":{"jobs":[{"name":"jruby-launcher","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"result":"SUCCESS","url":"http://ci.jruby.org/job/jruby-launcher/939/"}}]}}}}}} ;
        var data = {"GUT产品网管持续集成":{"jobs":[{"name":"GUT_AUTO_CLEAN_SERVER","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":625,"number":73,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/GUT_AUTO_CLEAN_SERVER/73/"}},{"name":"GUT_AUTO_DEPLOY_CLIENT_32","buildable":true,"healthReport":[{"score":20}],"lastBuild":{"building":false,"duration":1031609,"number":91,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/GUT_AUTO_DEPLOY_CLIENT_32/91/"}},{"name":"GUT_AUTO_DEPLOY_SERVER_125","buildable":true,"healthReport":[{"score":40}],"lastBuild":{"building":false,"duration":17732922,"number":53,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/GUT_AUTO_DEPLOY_SERVER_125/53/"}},{"name":"GUT_AUTO_DEPLOY_SERVER_60.1","buildable":true,"healthReport":[{"score":40}],"lastBuild":{"building":false,"duration":17185234,"number":100,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/GUT_AUTO_DEPLOY_SERVER_60.1/100/"}},{"name":"AutoTest_EMS_Log_CreateOMMagent_32","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":469,"number":74,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/AutoTest_EMS_Log_CreateOMMagent_32/74/"}},{"name":"AutoTest_EMS_GUT_smoketest_32","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":453,"number":77,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/AutoTest_EMS_GUT_smoketest_32/77/"}}],"submodules":{"EMS子项目持续集成":{"jobs":[{"name":"GUT_AUTO_DEPLOY_REDUCE_STEP","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":328,"number":87,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/GUT_AUTO_DEPLOY_REDUCE_STEP/87/"}},{"name":"GUT_AUTO_DEPLOY_CLENT_WITHOUT_DOWNLOAD_33","buildable":true,"healthReport":[{"score":80}],"lastBuild":{"building":false,"duration":1020063,"number":12,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/GUT_AUTO_DEPLOY_CLENT_WITHOUT_DOWNLOAD_33/12/"}},{"name":"GUT_AUTO_DEPLOY_WITHOUT_DB","buildable":true,"healthReport":[{"score":60}],"lastBuild":{"building":false,"duration":3071641,"number":88,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/GUT_AUTO_DEPLOY_WITHOUT_DB/88/"}},{"name":"AutoTest_EMS_Log_CreateOMMagent_33","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":672,"number":56,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/AutoTest_EMS_Log_CreateOMMagent_33/56/"}},{"name":"AutoTest_EMS_GUT_smoketest_33","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":234,"number":58,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/AutoTest_EMS_GUT_smoketest_33/58/"}}],"submodules":{"GUT_OMMR应用":{"jobs":[{"name":"APP_AG_BUILD_V12.13.40","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":166781,"number":35,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/APP_AG_BUILD_V12.13.40/35/"}},{"name":"APP_GSM_BUILD_V12.13.40","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":673922,"number":61,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/APP_GSM_BUILD_V12.13.40/61/"}},{"name":"APP_GUT_BUILD_V12.13.40","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":281765,"number":50,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/APP_GUT_BUILD_V12.13.40/50/"}},{"name":"APP_ITC_BUILD_V12.13.40","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":126797,"number":27,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/APP_ITC_BUILD_V12.13.40/27/"}},{"name":"APP_TD_BUILD_V12.13.40","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":322562,"number":46,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/APP_TD_BUILD_V12.13.40/46/"}},{"name":"APP_UMTSV3_BUILD_V12.13.40","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":462563,"number":64,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/APP_UMTSV3_BUILD_V12.13.40/64/"}},{"name":"APP_UMTSV4_BUILD_V12.13.40","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":224609,"number":54,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/APP_UMTSV4_BUILD_V12.13.40/54/"}},{"name":"APP_UROP_BUILD_V12.13.40","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":68750,"number":70,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/APP_UROP_BUILD_V12.13.40/70/"}}]},"GUT_OMMB应用":{"jobs":[{"name":"APP_GOMMCB_BUILD_V12.13.40","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":45657,"number":73,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/APP_GOMMCB_BUILD_V12.13.40/73/"}},{"name":"APP_GSMB_BUILD_V12.13.40","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":55500,"number":18,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/APP_GSMB_BUILD_V12.13.40/18/"}},{"name":"APP_MEDIATOR_BUILD_V12.13.40","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":397765,"number":22,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/APP_MEDIATOR_BUILD_V12.13.40/22/"}},{"name":"APP_SDR_BUILD_V12.13.40","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":284750,"number":24,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/APP_SDR_BUILD_V12.13.40/24/"}},{"name":"APP_SDRMGR_BUILD_V12.13.40","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":492110,"number":245,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/APP_SDRMGR_BUILD_V12.13.40/245/"}},{"name":"APP_TDB_BUILD_V12.13.40","buildable":true,"healthReport":[{"score":80}],"lastBuild":{"building":false,"duration":47078,"number":33,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/APP_TDB_BUILD_V12.13.40/33/"}},{"name":"APP_UMTSOMMB_BUILD_V12.13.40","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":201516,"number":25,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/APP_UMTSOMMB_BUILD_V12.13.40/25/"}},{"name":"APP_UOMMCB_BUILD_V12.13.40","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":113969,"number":40,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/APP_UOMMCB_BUILD_V12.13.40/40/"}}]},"迁站":{"jobs":[{"name":"APP_GUTST_BUILD_V12.13.40","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":11188,"number":23,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/APP_GUTST_BUILD_V12.13.40/23/"}},{"name":"APP_OMMRTST_BUILD_V12.13.40","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":22125,"number":60,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/APP_OMMRTST_BUILD_V12.13.40/60/"}},{"name":"APP_TTST_BUILD_V12.13.40","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":12719,"number":20,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/APP_TTST_BUILD_V12.13.40/20/"}}]},"GUT北向":{"jobs":[{"name":"ems-naf-gut-buildTest-V12.13.40","buildable":true,"healthReport":[{"score":100},{"score":100}],"lastBuild":{"building":false,"duration":200109,"number":214,"result":"SUCCESS","url":"http://10.62.57.220:8080/job/ems-naf-gut-buildTest-V12.13.40/214/"}}]}}},"OMMR子项目持续集成":{"jobs":[{"name":"AutoTest","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":0,"number":145,"result":"SUCCESS","url":"http://10.62.100.161/jenkins/job/AutoTest/145/"}},{"name":"OMMR(R4V1213)_makeVersion","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":336797,"number":131,"result":"SUCCESS","url":"http://10.62.100.161/jenkins/job/OMMR(R4V1213)_makeVersion/131/"}},{"name":"ZXM-OMMR(V12.13)_V4_Server_Install","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":483891,"number":157,"result":"SUCCESS","url":"http://10.62.100.161/jenkins/job/ZXM-OMMR(V12.13)_V4_Server_Install/157/"}},{"name":"ZXM-OMMR(V12.13)_V4_Client","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":166454,"number":158,"result":"SUCCESS","url":"http://10.62.100.161/jenkins/job/ZXM-OMMR(V12.13)_V4_Client/158/"}},{"name":"ZXM-OMMR(V12.13)_V4_Server_Start","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":131563,"number":115,"result":"SUCCESS","url":"http://10.62.100.161/jenkins/job/ZXM-OMMR(V12.13)_V4_Server_Start/115/"}},{"name":"atp","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":180985,"number":164,"result":"SUCCESS","url":"http://10.62.100.161/jenkins/job/atp/164/"}}],"submodules":{"地面":{"jobs":[{"name":"OMMR(R4V1213)_dev","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":84500,"number":254,"result":"SUCCESS","url":"http://10.62.100.161/jenkins/job/OMMR(R4V1213)_dev/254/"},"alias":"dev"}]},"无线":{"jobs":[{"name":"OMMR(R4V1213)_rrc","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":113250,"number":123,"result":"SUCCESS","url":"http://10.62.100.161/jenkins/job/OMMR(R4V1213)_rrc/123/"},"alias":"rrc"}]},"动态":{"jobs":[{"name":"OMMR(R4V1213)_ddm","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":285890,"number":208,"result":"SUCCESS","url":"http://10.62.100.161/jenkins/job/OMMR(R4V1213)_ddm/208/"},"alias":"动态"}]},"性能":{"jobs":[{"name":"OMMR(R4V1213)_pft","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":34343,"number":128,"result":"SUCCESS","url":"http://10.62.100.161/jenkins/job/OMMR(R4V1213)_pft/128/"},"alias":"性能"}]},"通用":{"jobs":[{"name":"OMMR(R4V1213)_quickConf","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":18281,"number":111,"result":"SUCCESS","url":"http://10.62.100.161/jenkins/job/OMMR(R4V1213)_quickConf/111/"},"alias":"快配"},{"name":"OMMR(R4V1213)_mml","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":65422,"number":35,"result":"SUCCESS","url":"http://10.62.100.161/jenkins/job/OMMR(R4V1213)_mml/35/"},"alias":"人机命令"},{"name":"OMMR(R4V1213)_groovy","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":86500,"number":144,"result":"SUCCESS","url":"http://10.62.100.161/jenkins/job/OMMR(R4V1213)_groovy/144/"},"alias":"约束"}]}}},"OMMB子项目持续集成":{"jobs":[{"name":"01_GU-OMMB_AutoAssemble","buildable":true,"healthReport":[{"score":60}],"lastBuild":{"building":false,"duration":1199234,"number":77,"result":"SUCCESS","url":"http://10.9.176.81:8181/CI/job/01_GU-OMMB_AutoAssemble/77/"}},{"name":"02_GU-OMMB_AutoInstall","buildable":true,"healthReport":[{"score":0}],"lastBuild":{"building":false,"duration":589062,"number":99,"result":"FAILURE","url":"http://10.9.176.81:8181/CI/job/02_GU-OMMB_AutoInstall/99/"}},{"name":"03_GU-OMMB_PrepareTest","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":221594,"number":110,"result":"SUCCESS","url":"http://10.9.176.81:8181/CI/job/03_GU-OMMB_PrepareTest/110/"}},{"name":"04_GU-OMMB_AutoTest","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":true,"duration":0,"number":153,"result":null,"url":"http://10.9.176.81:8181/CI/job/04_GU-OMMB_AutoTest/153/"}},{"name":"05_GU-OMMB_CodeCover","buildable":true,"healthReport":[{"score":100}],"lastBuild":{"building":false,"duration":7945766,"number":107,"result":"ABORTED","url":"http://10.9.176.81:8181/CI/job/05_GU-OMMB_CodeCover/107/"}}],"submodules":{}}}}}

        var project = {};
        var sub_projects = [];

        function get_jobs_dom(jobs){
            ret = "";
            $.each(jobs.slice(0,6),function(index,job){
                var class_job = 'doing';
                b = job.lastBuild;
                if(!b.building){
                    class_job = 'success';
                    if(b.result != "SUCCESS")
                        class_job = 'fail'
                }
                ret = ret + '<div class="job clearfix"><div class="status '+class_job+'"><p class="number">#'+b.number+'</p></div>'+
                        '<div class="job-content"><div class="job-title">'+job.name.substring(0,6)+'</div><div class="job-time">'+b.duration+'</div></div>' +
                        '</div>';
            });         
            return ret;
        }

        $(function() {
            for (var key in data){
                project.name = key;
                project.jobs = data[key].jobs;
                project.sub_project = data[key].submodules;
            }
            for (var key in project.sub_project){               
                var sub_project = {};
                sub_project.name = key;
                sub_project.jobs = project.sub_project[key].jobs;
                sub_project.ci_modules=[];
                for(var sub in project.sub_project[key].submodules){
                    var ci_modules = {};
                    ci_modules.name = sub;
                    ci_modules.jobs = project.sub_project[key].submodules[sub].jobs;
                    sub_project.ci_modules.push(ci_modules);
                }
                sub_projects.push(sub_project);
            }       
            
            $("#txt_product").html(project.name.substring(0,8));
            $("#jobs_product").append(get_jobs_dom(project.jobs));

            $.each(sub_projects,function(index,sub_project){
                var div_sub_project = $('<div class="row-of-sub-object clearfix"><div class="arrow front"><span class="glyphicon glyphicon-chevron-left"></span></div><div class="jobs-group sub-project"><div class="group-header">'+sub_project.name.substring(0,8)+'</div><div class="group-content" id=jobs_'+index+'></div></div></div>');
                $("#box_sub_project").append(div_sub_project);
                $("#jobs_"+index).append(get_jobs_dom(sub_project.jobs));
                sub_project.box_modules = $('<div class="row-of-sub-object"></div>');
                sub_project.box_modules.append($('<div class="arrow front"><span class="glyphicon glyphicon-chevron-left"></span></div>'));
                $("#box_module").append(sub_project.box_modules);

            });

            $.each(sub_projects,function(index,sub_project){
                $.each(sub_project.ci_modules,function(i,ci_module){
                    var header = $('<div class="group-header">'+ci_module.name+'</div>');
                    var content = $('<div class="group-content"></div>');
                    content.append(get_jobs_dom(ci_module.jobs));
                    var box = $('<div class="jobs-group module"></div>');
                    box.append(header);
                    box.append(content);
                    sub_project.box_modules.append(box);
                                     
                    
                    
                    //$("#sub_project_"+index).append('<div class="col-md-3" id=module_'+index+'_'+i+'>'+ci_module.name+'</div>');
                    //$("#module_"+index+"_"+i).append(get_jobs_dom(ci_module.jobs));
                    
                });
            });
        });
    </script>
</body>
</html>
